## Цель
Создание социального казино. 
Суть продукта: люди приходят, регистрируются на продукте, играют в слоты, люди могут выигрывать реальные деньги выполняя целевые действия (к примеру играя в турнир). Фактически дальний аналог фаусета, или мотива, но при этом у нас есть выраженное отличие — мы предлагаем людям играть в слоты в той или иной форме, и платим им за это. То есть помимо денег бесплатно, мы все же предлагаем фан.
Заработок на рекламе, мы рекламируем оферы казино, сливая на них трафик. При этом в отличие от обычного обзорника или каталога мы имеем свой собственный ретеншен, построенный на предложении выиграть бесплатно.
Мы хотим получать аквизишен, промотируя социальное продвижение продукта со стороны самих пользователей. К примеру пригласи друга, пошарь победу в соц сети и т.п. При этом результат социального действия должен конвертироваться в какой-то результат на платформе. 

## PreConditions
Провайдеры игр готовы давать нам игры бесплатно. При этом мы можем в демо игру провайдера загрузить начальный баланс (к примеру играть на валюту FUN) пользователя и так же получать обновления баланса. Если у нас нет слотов с которых можно получать результаты игры, то мы не сможем организовать соревнования. (
> TODO: Желательно получить АПИ
> TODO: дадут ли нам на FUN возможность использовать FreeSpins (чтобы мы могли выдать игроку 10 фриспинов по ставке 5)?
## User Stories
Я как пользователь прихожу на сайт, вижу предложение поучаствовать в турнире, с розыгрышем 100usd. Для участия в розыгрыше мне необходимо зарегистрироваться (при регистрации я отдаю свой email для контактов). После регистрации я вижу список турниров для участия. Нажав участвовать в турнире я получаю баланс. В рамках баланса я могу играть на разрешенных в турнире аппаратах. Проиграв все бонусные деньги, я занимаю призовое место в турнирной таблице и баннер с предложением получить бонус на реальный депозит.
На следующий день мне приходит письмо, и пуш с уведомлением о доступности нового турнира.
> TODO: Rewrite 

### Описание механики турнира
Игроки, участвующие в турнире, представляют группу (игроки имеющий один тег). Каждый участник получает сумму XX на счет. Игроки проигрывают деньги на счету. Для каждого кошелька мы считаем total win по счету в рамках турнира. Мы сортируем пользователей по параметру total win в рамках турнира, чтобы определить места в таблице участников. На момент окончания турнира мы фиксируем места людей, и призовые места получают призы. Деньги, которые остались не проигранными в рамках турнира — сгорают.
> TODO: описать желаемые механики турнира, к примеру глобальный турнир, турнир дня и т.п.
## Функциональные блоки
### Регистрация (client)
Я могу зарегистрироваться любым способом, который оставит информацию о моем емейле. 

К примеру:
- регистрация по е-мейл (confirm email, reset password)
- регистрация через oauth (gmail, facebook, yandex, vk, ok)

Неясна судьба регистрации через телеграм — телеграм не содержит е-мейла, вероятно для регистрации через телеграм необходимо реализовывать какую-то дополнительную логику (к примеру подписка на канал в телеге).

> TODO: описать механику бота TG для ретеншена и авторизации

Скорее всего мы хотели бы реализовать систему с [account links](https://lucia-auth.com/guides/oauth/account-linking), чтобы при регистрации к примеру через телеграм, в профиле пользователя можно было привязать дополнительные способы авторизации (таким образом допустим получив бонус за дополнительную верификацию).

### Antifraud (client/admin)
Мы хотим помечать меткой suspicious пользователей с неуникальным fingerprint либо иными признаками подозрительности (is Bot к примеру для Selenium). Возможность автоматического саспенда аккаунта для ботов.
### Retention mails (client)
Мы хотим интегрировать customer.io, либо аналогичный сервис для построения retention flow.
> TODO: Выбрать какой (custmomer.io, carrotquest.com)
### Tournament (admin)
Модуль позволят создавать турниры.
Свойства турнира:
- время начала: время старта турнира
- время конца: время окончания турнира
- время начала показа: время, с которого турнир доступен на экране списка турниров
- auto-assignment: имя группы, которая автоматически будет добавлена в участники турнира при старте турнира, может быть пустым
- self-assignment: разрешить людям самостоятельно добавляться в турнир
- gameList: список игр, которые участвуют в турнире
- prizes: список призов, в порядке убывания места
- repeatable: автоматический повтор турнира (пока не ясно как это должно работать)

### Tournament (client)
Я как клиент должен иметь возможность видеть текущие турниры, прошлые турниры, будущие турниры. Я могу открыть турнир, и если я в нем не участвую — вступить в участие в турнире. На странице турнира необходимо показать баланс денег в рамках турнира, показать место в турнирной таблицы и призы за турнир.
### Chat (Client)
Чат для клиентов, глобальный на сайте. (Клановые чаты, турнирные чаты)
> TODO: посмотреть решения для готовых чатов
### Profile (client)
Я хочу иметь возможность заполнить свою карточку игрока.
Я как клиент могу привязать дополнительные профили в соц сетях.
Я как клиент, хочу видеть историю турниров, в которых я участвовал и какие места я занимал в турнире.
Я хочу видеть все выигрыши рельных денег, истрория транзакций и побед. (получение промокода, это тоже выигрыш)

### Levels (client)
> todo: describe
### Rewards (client)
> todo: describe
### Profile (admin)
> Я как админ, хочу видеть список сессий игрока на сайте, паузы между сессиями, на какие рекламные предложения реагировал пользователь, какие рекламные предложения были ему показаны (часть от DSP).

Важно: для управления игроками необходим механизм тегов. К примеру тег: depositor, more one year LT, somecasinoplayer. 

### KYC (Client)

### KYC (Admin)

#### Payout (Admin)
Добавить возможность делать пейауты из админки, которые бы автоматом вычитались из баланса пользователя.

### DSP
Нужно поискать какое-то готовое DSP решение, т.к. разработка своего дело очень затратное. Суть DSP - если мы знаем что по нашей партнерской ссылке игрок зарегистрировался на продукте x - мы более не должны ему показывать офер этого продукта. Минимальный DSP состоит из списка оферов, трекера кликов, настройки постбеков для учета регистраций и fd.
## Traffic Sources
Если мы привлекаем трафик из сеошки, то нам выгодно сохранять публичные страницы прошедших турниров, сохранять их в sitemap и максимально наращивать количество страниц на сайте.

	Comment: скорее всего сеошка не нужна и можно забить, на данный момент все привлечение paid traffic

## Technical decisions
### Основные требования:
Полностью кастомный дизайн. Сайт из ниши развлечений, необходимо максимально кастомные элементы с большим количеством красивых анимаций. Фактически мы должны показывать много анимированных элементов, много мелких деталей создают ощущение глубины проработки.

Максимально быстрая скорость загрузки — мы должны максимально быстро рендерить скелет приложения, после чего уже можно догружать недостающие блоки, информацию, анимацию.

### frontend (client)
Для фронтенда предлагается использовать [svelte](https://svelte.dev/) Он максимально заточен под разработку кастомных дизайнов. Для динамической догрузки данных мы хотим использовать функционал [streaming promises](https://geoffrich.net/posts/conditionally-stream-data/), публикуя приложение на [CloudFlare Pages](https://pages.cloudflare.com/) (у них есть нативная интеграция с SvelteKit для работы с догрузкой промисов). [SvelteKit](https://kit.svelte.dev/) предоставляет нам сразу и BFF (backend for frontend), легковесный бекенд для обеспечения [кеширования](https://developers.cloudflare.com/kv/) данных API и быстрых ответ клиентам. Сайт должен поддерживать многоязычность, для чего можно использовать [paraglideJS](https://inlang.com/m/gerre34r/library-inlang-paraglideJs). Для поддержки авторизации удобно использовать [lucia](https://lucia-auth.com/).
### Backoffice (admin)
Для админ панели и управления бизнес сущностями мы предлагаем отдельно поднять дополнительное приложение, админ панель. За базу такого приложения можно взять OSS CMS [Strapi](https://strapi.io/). Ее можно использовать для хранения информации о турнирах, игроках и т.п.
Для хранения информации об истории ставок, strapi не подходит, поэтому понадобится отдельно сделать модели данных и API для интеграции игр и расчета статистики по турнирам. Можно использовать тот же сервер strapi для разработки бекенда, но эти сущности не будет иметь репрезентации в виде сущностей страпи.


### Support Chat
Предлагаем использовать [Chatwoot](https://www.chatwoot.com/), его можно как на сайт встроить, так и для телеграмма использовать. 

